#include<bits/stdc++.h>

#define MOD 1000000007
#define MAX 100005
#define ll long long
#define slld(t) scanf("%lld",&t)
#define sd(t) scanf("%d",&t)
#define ss(x) scanf("%s",x)
#define pd(t) printf("%d\n",t)
#define plld(t) printf("%lld\n",t)
#define pii pair<int,int>
#define pll pair<ll,ll>
#define tr(container,it) for(typeof(container.begin()) it=container.begin();it!=container.end();it++)
#define mp(a,b) make_pair(a,b)
#define FF first
#define SS second
#define pb(x) push_back(x)
#define vi vector<int>
#define vpii vector<pii >
#define vll vector<ll>
#define clr(x) memset(x,0,sizeof(x))

#define FILEIO(name) \
    freopen(name".in", "r", stdin); \
    freopen(name".out", "w", stdout);

using namespace std;

double dp[6][21][401];
int arr[]={4, 6, 8, 10, 12, 20};
int mymap[]={0,0,0,0,0,0,1,0,2,0,3,0,4,0,0,0,0,0,0,0,5};

void pre(){
	clr(dp);
	for(int i=0;i<6;i++){
		int y=arr[i];
		for(int j=1;j<=y;j++){
			dp[i][1][j]=(y-j+1.0)/y;
		}
		for(int x=2;x<21;x++){
			for(int k=1;k<=x;k++) dp[i][x][k]=1;
			for(int k=x+1;k<=x*y;k++){
				for(int rn=1;rn<=y;rn++){
					dp[i][x][k]+=((k>rn)?dp[i][x-1][k-rn]:1)/y;
				}
			}
		}
	}
}

int main(){
	pre();
//	freopen("fighting_the_zombie.txt","r",stdin);
//	freopen("answer.txt","w",stdout);
	int t;sd(t);
	for(int tt=1;tt<=t;tt++){
		printf("Case #%d: ",tt);
		int h,s;sd(h);sd(s);
		double mx=0;
		while(s--){
			string spell;cin>>spell;
			bool z=0;
			int len=spell.length(),i;
			int x=0,y=0;
			for(i=0;i<len;i++){
				if(spell[i]=='d'){
					++i;
					break;
				}
				x=10*x+(spell[i]-'0');
			}
			for(;i<len;i++){
				if(spell[i]=='-'||spell[i]=='+'){
					++i;
					z=1;
					break;
				}
				y=10*y+(spell[i]-'0');
			}
			int lim=h;
			if(z){
				int Z=0;
				int sign=i-1;
				for(;i<len;i++){
					Z=10*Z+(spell[i]-'0');
				}
				if(spell[sign]=='-') lim+=Z;
				else lim-=Z;
			}
			double prob;
			if(lim<=0) prob=1;
			else if(lim>=401) prob=0;
			else prob=dp[mymap[y]][x][lim];
			if(prob>mx) mx=prob;
		}
		printf("%.6lf\n",mx);
	}
}
